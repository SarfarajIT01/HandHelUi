@page "/runningOrders"

<h2 class="page-title">Running Table Orders (Panel View)</h2>

<div class="panel-layout">
    <!-- Left Table List -->
    <div class="table-list">
        @foreach (var table in Tables)
        {
            <div class="table-item @(SelectedTable == table ? "active" : "")"
                 @onclick="() => SelectTable(table)">
                <b>Table - @table.TableNo</b><br />
                <small>@table.GuestType | @table.Location</small><br />
                <small>Cover: @table.Cover | Stw: @table.StewardId</small>
            </div>
        }
    </div>

    <!-- Right Detail Panel -->
    <div class="details-panel">
        @if (SelectedTable != null)
        {
            <h3>Table - @SelectedTable.TableNo</h3>
            @foreach (var order in SelectedTable.Orders)
            {
                <div class="order-block">
                    <div class="order-header">@order.BillNo | @order.DateTime.ToString("dd/MM/yyyy HH:mm")</div>
                    @foreach (var item in order.Items)
                    {
                        <div class="order-item">
                            <span>@item.Name</span>
                            <span>@item.Qty Qty</span>
                            <span>₹ @item.Amount</span>
                        </div>
                    }
                    <div class="summary">
                        <div><b>Sub-Total</b><span>₹ @order.SubTotal</span></div>
                        <div><b>Tax</b><span>₹ @order.Tax</span></div>
                        <div class="grand-total"><b>Grand Total</b><span>₹ @order.GrandTotal</span></div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="placeholder">Select a table to view details</div>
        }
    </div>
</div>

@code {
    private TableModel SelectedTable;

    void SelectTable(TableModel table) => SelectedTable = table;
}

@code {
    public List<TableModel> Tables = new();

    protected override void OnInitialized()
    {
        Tables = new()
        {
            new TableModel
            {
                TableNo = "009",
                GuestType = "GUEST",
                Location = "RESTAURANT",
                Cover = 1,
                StewardId = "a",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152855",
                        DateTime = DateTime.Now,
                        Items = new()
                        {
                            new OrderItem { Name = "FRIED FISH", Qty = 1, Amount = 343 },
                            new OrderItem { Name = "BUTTER NAAN", Qty = 2, Amount = 120 },
                        },
                        SubTotal = 463,
                        Tax = 20,
                        GrandTotal = 483
                    },
                    new OrderModel
                    {
                        BillNo = "RG1152856",
                        DateTime = DateTime.Now.AddMinutes(-30),
                        Items = new()
                        {
                            new OrderItem { Name = "CHICKEN TIKKA", Qty = 1, Amount = 220 },
                        },
                        SubTotal = 220,
                        Tax = 15,
                        GrandTotal = 235
                    }
                }
            },
            new TableModel
            {
                TableNo = "010",
                GuestType = "MEMBER",
                Location = "LOUNGE",
                Cover = 2,
                StewardId = "b",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152857",
                        DateTime = DateTime.Now.AddMinutes(-15),
                        Items = new()
                        {
                            new OrderItem { Name = "MUTTON CURRY", Qty = 1, Amount = 480 },
                            new OrderItem { Name = "JEERA RICE", Qty = 1, Amount = 100 },
                        },
                        SubTotal = 580,
                        Tax = 30,
                        GrandTotal = 610
                    }
                }
            },
            new TableModel
            {
                TableNo = "009",
                GuestType = "GUEST",
                Location = "RESTAURANT",
                Cover = 1,
                StewardId = "a",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152855",
                        DateTime = DateTime.Now,
                        Items = new()
                        {
                            new OrderItem { Name = "FRIED FISH", Qty = 1, Amount = 343 },
                            new OrderItem { Name = "BUTTER NAAN", Qty = 2, Amount = 120 },
                        },
                        SubTotal = 463,
                        Tax = 20,
                        GrandTotal = 483
                    },
                    new OrderModel
                    {
                        BillNo = "RG1152856",
                        DateTime = DateTime.Now.AddMinutes(-30),
                        Items = new()
                        {
                            new OrderItem { Name = "CHICKEN TIKKA", Qty = 1, Amount = 220 },
                        },
                        SubTotal = 220,
                        Tax = 15,
                        GrandTotal = 235
                    }
                }
            },
            new TableModel
            {
                TableNo = "010",
                GuestType = "MEMBER",
                Location = "LOUNGE",
                Cover = 2,
                StewardId = "b",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152857",
                        DateTime = DateTime.Now.AddMinutes(-15),
                        Items = new()
                        {
                            new OrderItem { Name = "MUTTON CURRY", Qty = 1, Amount = 480 },
                            new OrderItem { Name = "JEERA RICE", Qty = 1, Amount = 100 },
                        },
                        SubTotal = 580,
                        Tax = 30,
                        GrandTotal = 610
                    }
                }
            },
            new TableModel
            {
                TableNo = "009",
                GuestType = "GUEST",
                Location = "RESTAURANT",
                Cover = 1,
                StewardId = "a",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152855",
                        DateTime = DateTime.Now,
                        Items = new()
                        {
                            new OrderItem { Name = "FRIED FISH", Qty = 1, Amount = 343 },
                            new OrderItem { Name = "BUTTER NAAN", Qty = 2, Amount = 120 },
                        },
                        SubTotal = 463,
                        Tax = 20,
                        GrandTotal = 483
                    },
                    new OrderModel
                    {
                        BillNo = "RG1152856",
                        DateTime = DateTime.Now.AddMinutes(-30),
                        Items = new()
                        {
                            new OrderItem { Name = "CHICKEN TIKKA", Qty = 1, Amount = 220 },
                        },
                        SubTotal = 220,
                        Tax = 15,
                        GrandTotal = 235
                    }
                }
            },
            new TableModel
            {
                TableNo = "010",
                GuestType = "MEMBER",
                Location = "LOUNGE",
                Cover = 2,
                StewardId = "b",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152857",
                        DateTime = DateTime.Now.AddMinutes(-15),
                        Items = new()
                        {
                            new OrderItem { Name = "MUTTON CURRY", Qty = 1, Amount = 480 },
                            new OrderItem { Name = "JEERA RICE", Qty = 1, Amount = 100 },
                        },
                        SubTotal = 580,
                        Tax = 30,
                        GrandTotal = 610
                    }
                }
            },
            new TableModel
            {
                TableNo = "009",
                GuestType = "GUEST",
                Location = "RESTAURANT",
                Cover = 1,
                StewardId = "a",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152855",
                        DateTime = DateTime.Now,
                        Items = new()
                        {
                            new OrderItem { Name = "FRIED FISH", Qty = 1, Amount = 343 },
                            new OrderItem { Name = "BUTTER NAAN", Qty = 2, Amount = 120 },
                        },
                        SubTotal = 463,
                        Tax = 20,
                        GrandTotal = 483
                    },
                    new OrderModel
                    {
                        BillNo = "RG1152856",
                        DateTime = DateTime.Now.AddMinutes(-30),
                        Items = new()
                        {
                            new OrderItem { Name = "CHICKEN TIKKA", Qty = 1, Amount = 220 },
                        },
                        SubTotal = 220,
                        Tax = 15,
                        GrandTotal = 235
                    }
                }
            },
            new TableModel
            {
                TableNo = "010",
                GuestType = "MEMBER",
                Location = "LOUNGE",
                Cover = 2,
                StewardId = "b",
                Orders = new()
                {
                    new OrderModel
                    {
                        BillNo = "RG1152857",
                        DateTime = DateTime.Now.AddMinutes(-15),
                        Items = new()
                        {
                            new OrderItem { Name = "MUTTON CURRY", Qty = 1, Amount = 480 },
                            new OrderItem { Name = "JEERA RICE", Qty = 1, Amount = 100 },
                        },
                        SubTotal = 580,
                        Tax = 30,
                        GrandTotal = 610
                    }
                }
            }
        };
    }

    public class TableModel
    {
        public string TableNo { get; set; }
        public string GuestType { get; set; }
        public string Location { get; set; }
        public short Cover { get; set; }
        public string StewardId { get; set; }
        public List<OrderModel> Orders { get; set; } = new();
    }

    public class OrderModel
    {
        public string BillNo { get; set; }
        public DateTime DateTime { get; set; }
        public List<OrderItem> Items { get; set; } = new();
        public decimal SubTotal { get; set; }
        public decimal Tax { get; set; }
        public decimal GrandTotal { get; set; }
    }

    public class OrderItem
    {
        public string Name { get; set; }
        public int Qty { get; set; }
        public decimal Amount { get; set; }
    }
}


<style>
    .panel-layout {
        display: grid;
        grid-template-columns: 1fr 2fr;
        height: calc(100vh - 80px);
        overflow: hidden;
    }

    .table-list {
        background: #f8f8f8;
        overflow-y: auto;
        padding: 1rem;
        border-right: 1px solid #ddd;
    }

    .table-item {
        background: white;
        border-radius: 10px;
        padding: 0.8rem;
        margin-bottom: 0.6rem;
        cursor: pointer;
        transition: 0.2s;
        box-shadow: 0 1px 3px rgba(0,0,0,0.08);
    }

        .table-item:hover {
            background: #eef6ff;
        }

        .table-item.active {
            border-left: 4px solid #0078ff;
            background: #e8f2ff;
        }

    .details-panel {
        background: #ffffff;
        padding: 1rem;
        overflow-y: auto;
    }

    .placeholder {
        text-align: center;
        color: #888;
        margin-top: 50px;
    }

    .order-block {
        margin-bottom: 1rem;
        background: #f8faff;
        border-radius: 10px;
        padding: 0.6rem;
    }

    .order-header {
        background: linear-gradient(90deg, #0078ff, #2b9fff);
        color: white;
        padding: 0.3rem 0.5rem;
        border-radius: 8px;
        font-weight: 600;
    }

    .order-item, .summary div {
        display: flex;
        justify-content: space-between;
        padding: 0.3rem 0.4rem;
    }

    .grand-total {
        background: linear-gradient(90deg, #00c46a, #00a95c);
        color: white;
        border-radius: 8px;
        padding: 0.3rem 0.5rem;
    }

</style>